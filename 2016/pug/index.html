<!DOCTYPE html><html><head><title>Pug is so cool | Carlog</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><link rel="alternate" href="atom.xml" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/main.css" type="text/css"></head><body><header><div class="wrapper"><a href="/" class="site-title"><code>Carlog</code></a><div class="menu"><span class="hamburger"><span></span></span></div><nav role="navigation" class="nav"><a href="/">Home</a><a href="/archives">Archives</a><a href="/atom.xml">RSS</a></nav></div></header><section class="main post"><div class="wrapper clearfix"><div class="post-header"><h2 class="post-title"><a href="/2016/pug/">Pug is so cool</a></h2><time datetime="2016-07-27T16:00:00.000Z">July 28, 2016</time></div><div class="post-content"><p>因为之前用 Python, 其最有名的 template 就是 <a href="http://jinja.pocoo.org/" target="_blank" rel="external">Jinja2</a>，所以在开始使用 JavaScript 的 html template 的时候，我就尝试和 Jinja2 非常相似的 <a href="http://paularmstrong.github.io/swig/" target="_blank" rel="external">Swig</a>。后来觉得 Swig 写起来不够自由，所以后面又使用 <a href="https://github.com/mde/ejs" target="_blank" rel="external">ejs</a>，ejs 写起来是很自由，但写完之后，读起来很难受，改起来也很难受。</p>
<p>而目前我最喜欢的 template engine 是 Pug（之前叫Jade）.</p>
<p>Pug 用起来很简单。层级分明，读起来也很舒服。</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><div class="line">doctype <span class="selector-tag">html</span></div><div class="line"><span class="selector-tag">html</span></div><div class="line">  head</div><div class="line">    meta(charset=<span class="string">"utf-8"</span>)</div><div class="line">    title Hello</div><div class="line">  <span class="selector-tag">body</span></div><div class="line">    main</div><div class="line">      <span class="selector-class">.left</span></div><div class="line">        <span class="selector-tag">p</span> Just some random text</div><div class="line">      <span class="selector-class">.right</span></div><div class="line">        <span class="selector-tag">p</span> Again, some random text</div><div class="line">    <span class="selector-tag">footer</span></div><div class="line">      <span class="selector-tag">p</span> Made by Haishan</div></pre></td></tr></table></figure>
<p>第一眼看起来你会觉得有点像是用<a href="http://emmet.io/" target="_blank" rel="external"><code>emmet</code></a>写 html。以致于我第一次看到 Pug(那个时候叫Jade)的时候就觉得这玩意是用来写 html，但当 template 用肯定不怎么样。但其实 Pug 本来就是用作 template 的。</p>
<p>如果只是字面值，可以这样：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><div class="line"><span class="selector-tag">p</span> Hello world!</div></pre></td></tr></table></figure>
<p>作为 template 我们也可以使用 Javascript 变量，比如下面的例子中，<code>pageName</code> 就是一个变量，这个变量可以是 render 的时候传进去的，也可以是该 Pug 文件前面已经对其进行了定义。</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><div class="line"><span class="attr">title</span>= pageName</div></pre></td></tr></table></figure>
<p>也可以使用 <code>!=</code> 符号，这样后面变量中的内容不会被转义。而使用 <code>=</code>，变量的内容会做 html tag 转义。</p>
<figure class="highlight erlang-repl"><table><tr><td class="code"><pre><div class="line">p!= pageParagraph1</div></pre></td></tr></table></figure>
<p>当然也可以是这样：</p>
<figure class="highlight vhdl"><table><tr><td class="code"><pre><div class="line">p= <span class="symbol">'This</span> code <span class="keyword">is</span> &lt;escaped&gt;!'</div><div class="line">p!= <span class="symbol">'This</span> code <span class="keyword">is</span> &lt;<span class="keyword">strong</span>&gt;<span class="keyword">not</span>&lt;/<span class="keyword">strong</span>&gt; escaped!'</div></pre></td></tr></table></figure>
<p>你可以考虑一下，下面的内容会渲染成什么样</p>
<figure class="highlight vhdl"><table><tr><td class="code"><pre><div class="line">p!= <span class="symbol">'This</span> code <span class="keyword">is</span> &lt;<span class="keyword">strong</span>&gt;<span class="keyword">not</span>&lt;/<span class="keyword">strong</span>&gt; escaped!'</div><div class="line">p= <span class="symbol">'This</span> code <span class="keyword">is</span> &lt;<span class="keyword">strong</span>&gt;<span class="keyword">not</span>&lt;/<span class="keyword">strong</span>&gt; escaped!'</div><div class="line">p <span class="symbol">'This</span> code <span class="keyword">is</span> &lt;<span class="keyword">strong</span>&gt;<span class="keyword">not</span>&lt;/<span class="keyword">strong</span>&gt; escaped!'</div><div class="line">p This code <span class="keyword">is</span> &lt;<span class="keyword">strong</span>&gt;<span class="keyword">not</span>&lt;/<span class="keyword">strong</span>&gt; escaped!</div></pre></td></tr></table></figure>
<p>想知道答案？不告诉你，自己试试好，现在就试。</p>
<p>我们当然可以直接在 Pug 中去 import 其他 Pug 文件，使用的是 <code>include</code> 命令，比如下面的例子中会把 <code>cnt/hello.pug</code> 的内容包含进来：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><div class="line">main<span class="selector-class">.content</span></div><div class="line">  include cnt/hello</div></pre></td></tr></table></figure>
<p>如果是 Pug 文件的话，后缀可省。比如是要包含 html 文件的可以 <code>include cnt/another.html</code>。所以我有时想 inline svg 的时候，我就 <code>include logo.svg</code></p>
<p>tag 中<a href="http://jade-lang.com/reference/attributes/" target="_blank" rel="external">属性在 pug 中这样写</a>：</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><div class="line"><span class="keyword">a</span>(href=<span class="string">"https://github.com/haishanh"</span>, alt=<span class="string">"Haishan on GitHub"</span>) Haishan <span class="keyword">on</span> <span class="title">GitHub</span></div></pre></td></tr></table></figure>
<p>render 之后就是这样：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://github.com/haishanh"</span> <span class="attr">alt</span>=<span class="string">"Haishan on GitHub"</span>&gt;</span>Haishan on GitHub<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>为了易读可以写成这样：</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><div class="line"><span class="keyword">a</span>(</div><div class="line">  href=<span class="string">"https://github.com/haishanh"</span>,</div><div class="line">  alt=<span class="string">"Haishan on GitHub"</span></div><div class="line">) Haishan <span class="keyword">on</span> <span class="title">GitHub</span></div></pre></td></tr></table></figure>
<p>作为 template，我们也可以在 pug 中<a href="http://jade-lang.com/reference/code/" target="_blank" rel="external">直接使用 Javascript 代码</a>。</p>
<figure class="highlight haml"><table><tr><td class="code"><pre><div class="line">.container</div><div class="line">  -<span class="ruby"> var i = <span class="number">0</span>;</span></div><div class="line">  -<span class="ruby"> <span class="keyword">while</span>(i++ &lt; <span class="number">3</span>) &#123;</span></div><div class="line">      li same item</div><div class="line">  -<span class="ruby"> &#125;</span></div></pre></td></tr></table></figure>
<p>上面的代码 render 后的结果是这样的：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>same item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>same item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>same item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>如果层级分明的时候，可以不写大括号，写成这样：</p>
<figure class="highlight haml"><table><tr><td class="code"><pre><div class="line">.container</div><div class="line">  -<span class="ruby"> var i = <span class="number">0</span>;</span></div><div class="line">  -<span class="ruby"> <span class="keyword">while</span>(i++ &lt; <span class="number">3</span>)</span></div><div class="line">    li same item</div></pre></td></tr></table></figure>
<p>再提一句要注意层级：</p>
<figure class="highlight haml"><table><tr><td class="code"><pre><div class="line">.container</div><div class="line">  -<span class="ruby"> var i = <span class="number">0</span>;</span></div><div class="line">  -<span class="ruby"> <span class="keyword">while</span>(i &lt; <span class="number">3</span>)</span></div><div class="line">    li same item</div><div class="line">    -<span class="ruby"> i++;</span></div></pre></td></tr></table></figure>
<p>假设最后一句的 <code>- i++</code> 向前缩进2格的话，就会死循环了。</p>
<p>当然 Pug 还有很多有用的 feature，比如 <a href="http://jade-lang.com/reference/extends/" target="_blank" rel="external">extends</a>, <a href="http://jade-lang.com/reference/mixins/" target="_blank" rel="external">mixins</a>，等等。具体的自己再多看文档咯。</p>
</div><div class="post-footer">Updated on 16/08/09</div></div><div class="post-nav"><div style="height: 0; width: 0; position: absolute; visibility: hidden">
  <!-- inject:svg --><svg xmlns="http://www.w3.org/2000/svg"><symbol id="ic_chevron_left_white_24px" viewBox="0 0 24 24">
    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</symbol><symbol id="ic_chevron_right_white_24px" viewBox="0 0 24 24">
    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</symbol></svg><!-- endinjected -->
</div><a href="/2016/serve-index/" class="nav next">NEXT<svg class="icon right"><use xlink:href="#ic_chevron_right_white_24px"></use></svg></a></div></section><footer><h3>Carlog</h3><div class="additional"><span>&copy;</span> 2016 <a href="http://hanhaishan.com">Haishan</a><br> Powered by <a href="https://hexo.io">Hexo</a>, theme using <a href="https://github.com/haishanh/hexo-theme-zxcvb">zxcvb</a>, hosted by <a href="https://github.com/haishanh/blog/tree/gh-pages">Github Pages</a></div></footer><script src="/js/script.js"></script></body></html>